var MsOnePlayer;(function(n){function i(n,i,r){var u=new t(document.getElementById(n),i);u.onPlayerReady(r)}n.render=i;var t=function(){function n(t,i){var r=this,u;(this.playerDiv=t,this.playerData=i,this.playerReady=!1,this.onPlayerReadyCallbacks=[],this.playerEventListeners=[],this.onMessageReceived=function(t){if(t&&t.data&&t.origin===n.iframeOrigin)try{var i=JSON.parse(r.sanitize(t.data));if(!i||i.playerId!==r.playerId)return;i.data&&(r.playPosition=i.data);switch(i.eventName.toLowerCase()){case"playerready":r.playerReady=!0;r.doCallback(r.onPlayerReadyCallbacks,r);break;case"postjsllmessage":r.sendTelemetyData(i.data)}r.doCallback(r.playerEventListeners,{name:i.eventName})}catch(u){}},t&&i&&i.metadata&&i.metadata.videoId)&&(n.iframeOrigin[0]==="%"&&(n.iframeOrigin=n.iframeOriginDefault),n.siteName[0]==="%"&&(n.siteName=n.defaultSiteName),this.playerReady=!1,n.playerCount++,u=t.id||"player"+n.playerCount,this.playerId=u+"-oneplayer",this.createPlayer(),this.getCurrentTime=function(){return r.playPosition&&r.playPosition.currentTime||0},this.getDuration=this.getVideoDuration=function(){return r.playPosition&&r.playPosition.endTime-r.playPosition.startTime||0})}return n.prototype.getPlayPosition=function(){return this.playPosition},n.prototype.createPlayer=function(){var r=n.iframeOrigin,i,u,f,t;document.location.href.indexOf("/client/")>0&&document.location.href.indexOf("support.office")>=0&&(r+="/client");this.playerData&&this.playerData.options&&this.playerData.options.market&&(r+="/"+this.playerData.options.market);r+="/"+n.siteName+n.iframeUrlRight+this.playerData.metadata.videoId;i=this.playerData.options;u=this.getQueryParams(i);u&&u.length>0&&(r+="?"+u);f=document.getElementById(this.playerId);f&&f.parentElement.removeChild(f);t=document.createElement("iframe");t.id=this.playerId;t.src=r;t.setAttribute("class",n.iframeClass);t.setAttribute("allowfullscreen","true");t.setAttribute("frameborder","0");t.setAttribute("referrerpolicy","no-referrer-when-downgrade");t.style.height="100%";t.style.width="100%";t.setAttribute("name","Oneplayer iframe");this.playerData.metadata!=null&&this.playerData.metadata.title!=null&&t.setAttribute("title",this.playerData.metadata.title);i&&(i.height&&(t.height=i.height),i.width&&(t.width=i.width));this.iframeElement=t;this.playerDiv.appendChild(this.iframeElement);this.addEvent(window,"message",this.onMessageReceived)},n.prototype.addEvent=function(n,t,i){n.addEventListener?n.addEventListener(t,i,!1):n.attachEvent&&n.attachEvent("on"+t,i)},n.prototype.sanitize=function(n){var t={"<":"&lt;",">":"&gt;"};return n.replace(/[<>]/ig,function(n){return t[n]})},n.prototype.doCallback=function(n,t){var i,r,u;if(n)for(i=0,r=n;i<r.length;i++)u=r[i],u&&u(t)},n.prototype.sendPostMessage=function(n,t){if(this.iframeElement){var i={eventName:n,data:t,playerId:this.playerId};this.iframeElement.contentWindow.postMessage(JSON.stringify(i),"*")}},n.prototype.getQueryParams=function(n){var t=[],r,i;t.push("pid="+this.playerId);t.push("jsapi=true");r=window;r.awa&&r.awa.ct&&t.push("postJsllMsg=true");for(i in n)n.hasOwnProperty(i)&&typeof n[i]!="object"&&t.push(i+"="+n[i]);return t.join("&")},n.prototype.isPlayerReady=function(){return this.playerReady},n.prototype.play=function(){this.sendPostMessage("play")},n.prototype.pause=function(){this.sendPostMessage("pause")},n.prototype.mute=function(n){this.sendPostMessage(n!==undefined&&!n?"unmute":"mute")},n.prototype.unmute=function(){this.sendPostMessage("unmute")},n.prototype.seek=function(n){this.sendPostMessage("seek",n)},n.prototype.enterFullScreen=function(){this.sendPostMessage("enterFullScreen")},n.prototype.exitFullScreen=function(){this.sendPostMessage("exitFullScreen")},n.prototype.updatePlayerSource=function(n){this.sendPostMessage("updatePlayerSource",n)},n.prototype.getCurrentTech=function(){return null},n.prototype.getCurrentType=function(){return null},n.prototype.onMediaDataLoaded=function(){},n.prototype.onPlayerReady=function(n){this.onPlayerReadyCallbacks.push(n)},n.prototype.sendTelemetyData=function(n){var t=window;t.awa&&t.awa.ct&&t.awa.ct.captureContentPageAction(n)},n.prototype.addPlayerEventListener=function(n){n&&this.playerEventListeners.push(n)},n.prototype.removePlayerEventListener=function(n){var t=this.playerEventListeners.indexOf(n);t>=0&&this.playerEventListeners.splice(t,1)},n.iframeClass="oneplayer-iframe",n.iframeOrigin="https://www.microsoft.com",n.iframeOriginDefault="https://www.microsoft.com",n.siteName="videoplayer",n.defaultSiteName="videoplayer",n.iframeUrlRight="/embed/",n.playerCount=0,n}();n.OnePlayer=t})(MsOnePlayer||(MsOnePlayer={}));/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/jakearchibald/es6-promise/master/LICENSE
 * @version   3.0.2
 */
var MsnVideoUx,MsnVideo2;(function(){"use strict";function bt(n){return typeof n=="function"||typeof n=="object"&&n!==null}function b(n){return typeof n=="function"}function kt(n){return typeof n=="object"&&n!==null}function dt(n){k=n}function gt(n){u=n}function ii(){return function(){process.nextTick(h)}}function ri(){return function(){rt(h)}}function ui(){var n=0,i=new et(h),t=document.createTextNode("");return i.observe(t,{characterData:!0}),function(){t.data=n=++n%2}}function fi(){var n=new MessageChannel;return n.port1.onmessage=h,function(){n.port2.postMessage(0)}}function ot(){return function(){setTimeout(h,1)}}function h(){for(var t,i,n=0;n<s;n+=2)t=f[n],i=f[n+1],t(i),f[n]=undefined,f[n+1]=undefined;s=0}function ei(){try{var t=require,n=t("vertx");return rt=n.runOnLoop||n.runOnContext,ri()}catch(i){return ot()}}function c(){}function oi(){return new TypeError("You cannot resolve a promise with itself")}function si(){return new TypeError("A promises callback cannot return that same promise.")}function hi(n){try{return n.then}catch(t){return v.error=t,v}}function ci(n,t,i,r){try{n.call(t,i,r)}catch(u){return u}}function li(t,r,f){u(function(t){var u=!1,e=ci(f,r,function(n){u||(u=!0,r!==n?a(t,n):i(t,n))},function(i){u||(u=!0,n(t,i))},"Settle: "+(t._label||" unknown promise"));!u&&e&&(u=!0,n(t,e))},t)}function ai(t,r){r._state===l?i(t,r._result):r._state===o?n(t,r._result):y(r,undefined,function(n){a(t,n)},function(i){n(t,i)})}function vi(t,r){if(r.constructor===t.constructor)ai(t,r);else{var u=hi(r);u===v?n(t,v.error):u===undefined?i(t,r):b(u)?li(t,r,u):i(t,r)}}function a(t,r){t===r?n(t,oi()):bt(r)?vi(t,r):i(t,r)}function yi(n){n._onerror&&n._onerror(n._result);d(n)}function i(n,t){n._state===e&&(n._result=t,n._state=l,n._subscribers.length!==0&&u(d,n))}function n(n,t){n._state===e&&(n._state=o,n._result=t,u(yi,n))}function y(n,t,i,r){var f=n._subscribers,e=f.length;n._onerror=null;f[e]=t;f[e+l]=i;f[e+o]=r;e===0&&n._state&&u(d,n)}function d(n){var i=n._subscribers,e=n._state,r,u,f,t;if(i.length!==0){for(f=n._result,t=0;t<i.length;t+=3)r=i[t],u=i[t+e],r?ct(e,r,u,f):u(f);n._subscribers.length=0}}function ht(){this.error=null}function pi(n,t){try{return n(t)}catch(i){return p.error=i,p}}function ct(t,r,u,f){var c=b(u),s,v,h,y;if(c){if(s=pi(u,f),s===p?(y=!0,v=s.error,s=null):h=!0,r===s){n(r,si());return}}else s=f,h=!0;r._state!==e||(c&&h?a(r,s):y?n(r,v):t===l?i(r,s):t===o&&n(r,s))}function wi(t,i){try{i(function(n){a(t,n)},function(i){n(t,i)})}catch(r){n(t,r)}}function r(t,r){var u=this;u._instanceConstructor=t;u.promise=new t(c);u._validateInput(r)?(u._input=r,u.length=r.length,u._remaining=r.length,u._init(),u.length===0?i(u.promise,u._result):(u.length=u.length||0,u._enumerate(),u._remaining===0&&i(u.promise,u._result))):n(u.promise,u._validationError())}function bi(n){return new lt(this,n).promise}function ki(t){function o(n){a(i,n)}function s(t){n(i,t)}var u=this,i=new u(c),f,r;if(!it(t))return n(i,new TypeError("You must pass an array to race.")),i;for(f=t.length,r=0;i._state===e&&r<f;r++)y(u.resolve(t[r]),undefined,o,s);return i}function di(n){var i=this,t;return n&&typeof n=="object"&&n.constructor===i?n:(t=new i(c),a(t,n),t)}function gi(t){var r=this,i=new r(c);return n(i,t),i}function nr(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");}function tr(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");}function t(n){this._id=wt++;this._state=undefined;this._result=undefined;this._subscribers=[];c!==n&&(b(n)||nr(),this instanceof t||tr(),wi(this,n))}function ir(){var n,t;if(typeof global!="undefined")n=global;else if(typeof self!="undefined")n=self;else try{n=Function("return this")()}catch(i){throw new Error("polyfill failed because global object is unavailable in this environment");}(t=n.Promise,!t||Object.prototype.toString.call(t.resolve())!=="[object Promise]"||t.cast)&&(n.Promise=g)}var tt,f,st,p,lt,at,vt,yt,pt,wt,g,nt,w;tt=Array.isArray?Array.isArray:function(n){return Object.prototype.toString.call(n)==="[object Array]"};var it=tt,s=0,rr={}.toString,rt,k,u=function(n,t){f[s]=n;f[s+1]=t;s+=2;s===2&&(k?k(h):st())};var ut=typeof window!="undefined"?window:undefined,ft=ut||{},et=ft.MutationObserver||ft.WebKitMutationObserver,ni=typeof process!="undefined"&&{}.toString.call(process)==="[object process]",ti=typeof Uint8ClampedArray!="undefined"&&typeof importScripts!="undefined"&&typeof MessageChannel!="undefined";f=new Array(1e3);st=ni?ii():et?ui():ti?fi():ut===undefined&&typeof require=="function"?ei():ot();var e=void 0,l=1,o=2,v=new ht;p=new ht;r.prototype._validateInput=function(n){return it(n)};r.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")};r.prototype._init=function(){this._result=new Array(this.length)};lt=r;r.prototype._enumerate=function(){for(var n=this,i=n.length,r=n.promise,u=n._input,t=0;r._state===e&&t<i;t++)n._eachEntry(u[t],t)};r.prototype._eachEntry=function(n,t){var i=this,r=i._instanceConstructor;kt(n)?n.constructor===r&&n._state!==e?(n._onerror=null,i._settledAt(n._state,t,n._result)):i._willSettleAt(r.resolve(n),t):(i._remaining--,i._result[t]=n)};r.prototype._settledAt=function(t,r,u){var f=this,s=f.promise;s._state===e&&(f._remaining--,t===o?n(s,u):f._result[r]=u);f._remaining===0&&i(s,f._result)};r.prototype._willSettleAt=function(n,t){var i=this;y(n,undefined,function(n){i._settledAt(l,t,n)},function(n){i._settledAt(o,t,n)})};at=bi;vt=ki;yt=di;pt=gi;wt=0;g=t;t.all=at;t.race=vt;t.resolve=yt;t.reject=pt;t._setScheduler=dt;t._setAsap=gt;t._asap=u;t.prototype={constructor:t,then:function(n,t){var f=this,i=f._state,r,e,s;return i===l&&!n||i===o&&!t?this:(r=new this.constructor(c),e=f._result,i?(s=arguments[i-1],u(function(){ct(i,r,s,e)})):y(f,r,n,t),r)},"catch":function(n){return this.then(null,n)}};nt=ir;w={Promise:g,polyfill:nt};typeof define=="function"&&define.amd?define(function(){return w}):typeof module!="undefined"&&module.exports?module.exports=w:typeof this!="undefined"&&(this.ES6Promise=w);nt()}).call(this),function(n){function s(n,t,r,f,s,h){var c,b,v,k,a,p,w,l,y;if(t||(t=n),r||(r={}),f||(f={}),c=o(r),!t||!c||!c.defaultVideo)return null;for(b={videoId:c.defaultVideo,title:c.title},v={},c.autoPlay!==undefined&&(v.autoplay=c.autoPlay),c.mute!==undefined&&(v.mute=c.mute),c.loop!==undefined&&(v.loop=c.loop),c.autoCaptions!==undefined&&(v.autoCaption=c.autoCaptions),c.playFullScreen!==undefined&&(v.playFullScreen=c.playFullScreen),v.maskLevel=c.maskLevel!==undefined?c.maskLevel:20,v.market=e(),k={metadata:b,options:v},a=document.getElementById(t);a.firstChild;)a.removeChild(a.firstChild);return p=a.clientHeight,w=a.clientWidth,(!p||p<100||!w||w<100)&&(p=i.defaultPlayerHeight,w=i.defaultPlayerWidth),l=document.createElement("div"),l.id=t+"-subdiv",l.style.width=c.getWidthAsStyleString()||w.toString(),l.style.height=c.getHeightAsStyleString()||p.toString(),l.style.position="relative",l.style.height||(l.style.paddingTop="28.125%",l.style.paddingBottom="28.125%"),c.getHeightAsStyleString()==="100%"&&a.clientHeight===0&&(l.style.height=a.clientWidth*.5625+"px",l.style.paddingTop=undefined,l.style.paddingBottom=undefined),y=document.createElement("div"),y.id=t+"-innerdiv",y.style.top="0",y.style.bottom="0",y.style.position="absolute",y.style.height="100%",y.style.width="100%",l.appendChild(y),a.appendChild(l),new window.Promise(function(n){u(y.id,k,function(t){if(a.playerInstance=t,s)t.onEnd(function(){s()});t.addPlayerEventListener(function(n){(n.name.toLowerCase()==="contenterror"||n.name.toLowerCase()==="playererror")&&h&&h()});n(t)})})}function u(n,i,r){window.MsOnePlayer.render(n,i,function(n){var i=new t(n);r&&r(i)})}var i=function(){function n(){}return n.defaultPlayerWidth=512,n.defaultPlayerHeight=288,n}(),r=function(){function n(){this.csid=""}return n.prototype.getWidthAsNumber=function(){if(this.width){if(typeof this.width=="number")return this.width;if(!isNaN(this.width))return parseInt(this.width,10)}return undefined},n.prototype.getHeightAsNumber=function(){if(this.height){if(typeof this.height=="number")return this.height;if(!isNaN(this.height))return parseInt(this.height,10)}return undefined},n.prototype.getWidthAsStyleString=function(){var n=this.getWidthAsNumber();return typeof n=="number"?n.toString()+"px":typeof this.width!="undefined"?this.width.toString():undefined},n.prototype.getHeightAsStyleString=function(){var n=this.getHeightAsNumber();return typeof n=="number"?n.toString()+"px":typeof this.height!="undefined"?this.height.toString():undefined},n}(),t;n.PlayerDataConfig=r;var f={ar:"ar-sa",bg:"bg-bg",ca:"ca-es",cs:"cs-cz",da:"da-dk",de:"de-de",el:"el-gr",en:"en-us",es:"es-es",et:"et-ee",eu:"eu-es",fa:"fa-ir",fi:"fi-fi",fr:"fr-fr",gl:"gl-es",he:"he-il",hi:"hi-in",hr:"hr-hr",hu:"hu-hu",id:"id-id",is:"is-is",it:"it-it",ja:"ja-jp",kk:"kk-kz",ko:"ko-kr",lt:"lt-lt",lv:"lv-lv",ms:"ms-my",nb:"nb-no",nl:"nl-nl",nn:"nn-no",ph:"ph-ph",pl:"pl-pl",pt:"pt-pt",ro:"ro-ro",ru:"ru-ru",sk:"sk-sk",sl:"sl-si",sv:"sv-se",sr:"sr-latn-rs",th:"th-th",tl:"tl-ph",tr:"tr-tr",uk:"uk-ua",ur:"ur-pk",vi:"vi-vn",zh:"zh-cn"},e=function(){var n=(document.getElementsByTagName("html")[0].getAttribute("lang")||navigator.languages&&navigator.languages[0]||navigator.userLanguage||navigator.language||"en").toLowerCase();return f[n]||n},o=function(n){var i=new r,t,u;for(t in n)if(n.hasOwnProperty(t)){u=t.replace(/^.*\./,"");switch(u){case"DefaultVideo":i.defaultVideo=typeof n[t]=="string"?n[t].replace("videobyuuids.aspx?uuids=",""):n[t].videoQuery.videoFilter.uuids[0];break;case"VideoId":i.defaultVideo=n[t];break;case"DefaultPlayList":i.defaultPlayList=n[t].split(",");break;case"Width":i.width=n[t];break;case"Height":i.height=n[t];i.height==="0"&&(i.height=undefined);break;case"AutoPlayVideo":typeof n[t]=="string"?i.autoPlay=n[t].toLowerCase()==="true":typeof n[t]=="boolean"&&(i.autoPlay=n[t]);break;case"PlayFullScreen":typeof n[t]=="string"?i.playFullScreen=n[t].toLowerCase()==="true":typeof n[t]=="boolean"&&(i.playFullScreen=n[t]);break;case"Mute":typeof n[t]=="string"?i.mute=n[t].toLowerCase()==="true":typeof n[t]=="boolean"&&(i.mute=n[t]);break;case"Loop":typeof n[t]=="string"?i.loop=n[t].toLowerCase()==="true":typeof n[t]=="boolean"&&(i.loop=n[t]);break;case"AutoCaptions":i.autoCaptions=n[t];break;case"Title":i.title=n[t];break;case"MaskLevel":i.maskLevel=n[t];break;default:i[u]=n[t]}}return i.playFullScreen&&i.autoPlay&&(i.playFullScreen=!1),i};n.render=s;n.loadPlayer=u;t=function(){function n(n){var t=this;this.onePlayer=n;this.onMediaDataLoadedCallback=[];this.onPlayCallbacks=[];this.onPauseCallbacks=[];this.onEndCallbacks=[];this.onFullScreenChangedCallbacks=[];this.onPlayerEvent=function(n){switch(n.name.toLowerCase()){case"loadedmetadata":t.doCallback(t.onMediaDataLoadedCallback);break;case"play":t.doCallback(t.onPlayCallbacks);break;case"pause":t.doCallback(t.onPauseCallbacks);break;case"contentcomplete":t.doCallback(t.onEndCallbacks);break;case"fullscreenenter":t.doCallback(t.onFullScreenChangedCallbacks,!0);break;case"fullscreenexit":t.doCallback(t.onFullScreenChangedCallbacks,!1)}};n.addPlayerEventListener(this.onPlayerEvent)}return n.prototype.pause=function(){this.onePlayer&&this.onePlayer.pause&&this.onePlayer.pause()},n.prototype.play=function(){this.onePlayer&&this.onePlayer.play&&this.onePlayer.play()},n.prototype.mute=function(n){this.onePlayer&&this.onePlayer.mute&&this.onePlayer.mute(n)},n.prototype.seek=function(n){this.onePlayer&&this.onePlayer.seek&&this.onePlayer.seek(n)},n.prototype.enterFullScreen=function(){this.onePlayer&&this.onePlayer.enterFullScreen&&this.onePlayer.enterFullScreen()},n.prototype.exitFullScreen=function(){this.onePlayer&&this.onePlayer.exitFullScreen&&this.onePlayer.exitFullScreen()},n.prototype.getCurrentTech=function(){return"NA"},n.prototype.getCurrentType=function(){return"NA"},n.prototype.getCurrentTime=function(){var n=this.onePlayer&&this.onePlayer.getPlayPosition&&this.onePlayer.getPlayPosition();return n&&n.currentTime},n.prototype.getVideoDuration=function(){var n=this.onePlayer&&this.onePlayer.getPlayPosition&&this.onePlayer.getPlayPosition();return n&&n.endTime-n.startTime},n.prototype.onMediaDataLoaded=function(n){n&&this.onMediaDataLoadedCallback.push(n)},n.prototype.onPlay=function(n){n&&this.onPlayCallbacks.push(n)},n.prototype.onPause=function(n){n&&this.onPauseCallbacks.push(n)},n.prototype.onEnd=function(n){n&&this.onEndCallbacks.push(n)},n.prototype.onFullScreenChange=function(n){n&&this.onFullScreenChangedCallbacks.push(n)},n.prototype.addPlayerEventListener=function(n){this.onePlayer&&this.onePlayer.addPlayerEventListener&&this.onePlayer.addPlayerEventListener(n)},n.prototype.doCallback=function(n,t){var i,r,u;if(n)for(i=0,r=n;i<r.length;i++)u=r[i],u&&u(t)},n}();n.VhsPlayerShim=t}(MsnVideoUx||(MsnVideoUx={}));("undefined"==typeof MsnVideo2||null==MsnVideo2)&&(MsnVideo2=new function(){this.addMessageReceiver=function(){};this.removeMessageReceiver=function(){};this.sendMessage=function(n){var f=n.type.toLowerCase(),r,t;if(typeof n.targetId!="undefined"){var u="",i=/.+(?=_ux1)/i.exec(n.targetId);if(u=i==null||i.length<=0?n.targetId:i[0],r=document.getElementById(u),r&&(t=r.playerInstance,t))switch(f){case"pausevideo":t.pause();break;case"playvideo":t.play()}}}})